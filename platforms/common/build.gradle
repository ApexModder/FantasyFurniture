apply from: rootProject.file('gradle/scripts/common.gradle')

def FF_modules = [ ]

rootProject.childProjects.values().forEach { prj ->
    if(prj.path.endsWithIgnoreCase('-common')) {
        def moduleName = prj.path.substring(1, prj.path.indexOf('-'))

        if(!FF_modules.contains(moduleName)) {
            FF_modules.add(moduleName)
        }
    }
}

afterEvaluate {
    [ 'compileJava', 'processResources', 'classes' ].forEach { taskName ->
        tasks.getByName(taskName) { task ->
            FF_modules.forEach { module ->
                finalizedBy(":${module}-common:${taskName}")
            }
        }
    }
}